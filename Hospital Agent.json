{
  "name": "Hospital Agent",
  "nodes": [
    {
      "parameters": {
        "inputSource": "passthrough"
      },
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "typeVersion": 1.1,
      "position": [
        -352,
        0
      ],
      "id": "d343c130-7bf8-4116-a070-919f1905549d",
      "name": "When Executed by Another Workflow"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "# Role:\nYou are an intelligent agent who understand the user query  and uses tools to provide the information about the hospital, different services available, compare hospitals based on their location, and provide a chart as applicable based on the response to the user query.\n \nAlways include the phrase Hospital Overall Rating when mentioning any rating related info, even in natural language\n \nYou have 2  tools -Hospital_Info for hospital information, `Emergency_Info` to find emergency services,. You will review the user query carefully and use only relevant tool. Each of the tool information is given in detail below \n \n# Tools:\nYou are connected to tools:\n \n1. **Hospital_Info** : Is used to search for hospital information.These are the table fields separated by comma:\nProvider ID,Hospital Name,Address,City,State,ZIP Code,County Name,Phone Number,Hospital Type,Hospital Ownership,Emergency Services,Meets criteria for meaningful use of EHRs,Hospital overall rating,Hospital overall rating footnote,Mortality national comparison,Mortality national comparison footnote,Safety of care national comparison,Safety of care national comparison footnote,Readmission national comparison,Readmission national comparison footnote,Patient experience national comparison,Patient experience national comparison footnote,Effectiveness of care national comparison,Effectiveness of care national comparison footnote,Timeliness of care national comparison,Timeliness of care national comparison footnote,Efficient use of medical imaging national comparison,Efficient use of medical imaging national comparison footnote,Location\n2. Emergency_Info - To find the emergency services like ambulance availability in the hospitals of a given zipcode. They are these columns separated with comma Zip Code \tHospital Name        \tAmbulance Available\n \n# Guidelines:\n- Use tools to search for and answer all questions.\n- Use Emergency_Info tool for any emergency services related queries\n- Use Hospital Info for any hospital rating related queries. You will not use Hospital_Info for any emergency services queries\n- Each paragraph should begin with a relevant heading (e.g., Hospital Info, Emergency Access).\n- Use concise, readable English with proper formatting.\n- For AirTable Tools, generate a formula that is compatible with the Airtable API. Remember that to build formulas to search records in Airtable:\n- Field names must be wrapped in curly braces {Field Name}\n- String literals must be in double quotes\n- For case-insensitive searching, wrap fields and search terms in LOWER() or UPPER()\n- Boolean operations use AND(), OR(), NOT().\nSample:\n1) LOWER({Field Name}) = LOWER(\"search term\")\n2) OR(\n    LOWER({Field1}) = LOWER(\"term1\"),\n    LOWER({Field2}) = LOWER(\"term2\")\n)\n \n# Workflow:\n1. Parse the user's request: location, hospital type, quality criteria\n2. Query the `Hospital_Infor` or `Emergency_Info` as needed.\n4. Return your findings in clean paragraph form. Example\n \n**Hospital Info** \nMarshall Medical Center South is located in Boaz, AL 35957. It is an acute care hospital. The contact number is (256) 555-1234.\n \n**Care Quality** \nThe hospital has above-average timeliness of care and same-as-average patient experience.\n \n \n# Constraints:\n- Only use tools for data.\n- Never generate summaries or content on your own.\n \n# Ask When Needed:\n- Ask for clarification on quality measures if vague (e.g., “What do you mean by good?”).\n \n# Output Style:\n- Use paragraph structure; bullet points are optional.\n- Avoid raw JSON or tables unless asked.\n",
        "options": {
          "systemMessage": "# Role:\nYou are an intelligent agent who understand the user query  and uses tools to provide the information about the hospital, different services available, compare hospitals based on their location, and provide a chart as applicable based on the response to the user query.\n \nAlways include the phrase Hospital Overall Rating when mentioning any rating related info, even in natural language\n \nYou have 2  tools -Hospital_Info for hospital information, `Emergency_Info` to find emergency services,. You will review the user query carefully and use only relevant tool. Each of the tool information is given in detail below \n \n# Tools:\nYou are connected to tools:\n \n1. **Hospital_Info** : Is used to search for hospital information.These are the table fields separated by comma:\nProvider ID,Hospital Name,Address,City,State,ZIP Code,County Name,Phone Number,Hospital Type,Hospital Ownership,Emergency Services,Meets criteria for meaningful use of EHRs,Hospital overall rating,Hospital overall rating footnote,Mortality national comparison,Mortality national comparison footnote,Safety of care national comparison,Safety of care national comparison footnote,Readmission national comparison,Readmission national comparison footnote,Patient experience national comparison,Patient experience national comparison footnote,Effectiveness of care national comparison,Effectiveness of care national comparison footnote,Timeliness of care national comparison,Timeliness of care national comparison footnote,Efficient use of medical imaging national comparison,Efficient use of medical imaging national comparison footnote,Location\n2. Emergency_Info - To find the emergency services like ambulance availability in the hospitals of a given zipcode. They are these columns separated with comma Zip Code \tHospital Name        \tAmbulance Available\n \n# Guidelines:\n- Use tools to search for and answer all questions.\n- Use Emergency_Info tool for any emergency services related queries\n- Use Hospital Info for any hospital rating related queries. You will not use Hospital_Info for any emergency services queries\n- Each paragraph should begin with a relevant heading (e.g., Hospital Info, Emergency Access).\n- Use concise, readable English with proper formatting.\n- For AirTable Tools, generate a formula that is compatible with the Airtable API. Remember that to build formulas to search records in Airtable:\n- Field names must be wrapped in curly braces {Field Name}\n- String literals must be in double quotes\n- For case-insensitive searching, wrap fields and search terms in LOWER() or UPPER()\n- Boolean operations use AND(), OR(), NOT().\nSample:\n1) LOWER({Field Name}) = LOWER(\"search term\")\n2) OR(\n    LOWER({Field1}) = LOWER(\"term1\"),\n    LOWER({Field2}) = LOWER(\"term2\")\n)\n \n# Workflow:\n1. Parse the user's request: location, hospital type, quality criteria\n2. Query the `Hospital_Infor` or `Emergency_Info` as needed.\n4. Return your findings in clean paragraph form. Example\n \n**Hospital Info** \nMarshall Medical Center South is located in Boaz, AL 35957. It is an acute care hospital. The contact number is (256) 555-1234.\n \n**Care Quality** \nThe hospital has above-average timeliness of care and same-as-average patient experience.\n \n \n# Constraints:\n- Only use tools for data.\n- Never generate summaries or content on your own.\n \n# Ask When Needed:\n- Ask for clarification on quality measures if vague (e.g., “What do you mean by good?”).\n \n# Output Style:\n- Use paragraph structure; bullet points are optional.\n- Avoid raw JSON or tables unless asked.\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        -144,
        0
      ],
      "id": "3203a73b-d4c7-46e6-bda4-023018ffec3f",
      "name": "AI Agent",
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        -240,
        160
      ],
      "id": "296bfe61-f5fb-4d9b-b166-dc912cc8a484",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "1wVk2tVCKOUM4lZt",
          "name": "OpenAi account 2"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1hPBKKJ7x8X9jPGlKKGVIz0saV1wrH3dKBDmMVmyG9QQ",
          "mode": "list",
          "cachedResultName": "hospitals_emergency_data_Dec14",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1hPBKKJ7x8X9jPGlKKGVIz0saV1wrH3dKBDmMVmyG9QQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 505859323,
          "mode": "list",
          "cachedResultName": "hospitals_emergency_data",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1hPBKKJ7x8X9jPGlKKGVIz0saV1wrH3dKBDmMVmyG9QQ/edit#gid=505859323"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTool",
      "typeVersion": 4.7,
      "position": [
        288,
        144
      ],
      "id": "af8ffd46-e801-4c1f-bf4c-953ec24ba083",
      "name": "Get row(s) in sheet in Google Sheets",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "b9cVz6N7am0CglYD",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "160ukyjfB2lNYRuA4WOn-3u6lp7ZjJrO6wg_2dBWUv5I",
          "mode": "list",
          "cachedResultName": "Hospital_General_Info_Trim_Dec14",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/160ukyjfB2lNYRuA4WOn-3u6lp7ZjJrO6wg_2dBWUv5I/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1498452991,
          "mode": "list",
          "cachedResultName": "Hospital_General_Information_Tr",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/160ukyjfB2lNYRuA4WOn-3u6lp7ZjJrO6wg_2dBWUv5I/edit#gid=1498452991"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTool",
      "typeVersion": 4.7,
      "position": [
        112,
        176
      ],
      "id": "4935e8ab-b821-4708-a7bb-840484c92ef4",
      "name": "Get row(s) in sheet in Google Sheets1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "b9cVz6N7am0CglYD",
          "name": "Google Sheets account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "When Executed by Another Workflow": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet in Google Sheets": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet in Google Sheets1": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "9dc32694-b9cc-4238-a591-3b557c2c20e3",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "5126115a5d1acb3c4a0d17ab58af57746255ecf82a899e3437c8dfb038e2510e"
  },
  "id": "giubfHbkbO7HthIf",
  "tags": []
}